<!DOCTYPE html>
<html lang="en"><head>
<script src="W3_DataWranglingR_files/libs/clipboard/clipboard.min.js"></script>
<script src="W3_DataWranglingR_files/libs/quarto-html/tabby.min.js"></script>
<script src="W3_DataWranglingR_files/libs/quarto-html/popper.min.js"></script>
<script src="W3_DataWranglingR_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="W3_DataWranglingR_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="W3_DataWranglingR_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="W3_DataWranglingR_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="W3_DataWranglingR_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt)">
  <title>03 Data Wrangling</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="W3_DataWranglingR_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="W3_DataWranglingR_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="W3_DataWranglingR_files/libs/revealjs/dist/theme/quarto.css">
  <link href="W3_DataWranglingR_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="W3_DataWranglingR_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="W3_DataWranglingR_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="W3_DataWranglingR_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="W3_DataWranglingR_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="W3_DataWranglingR_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">03 Data Wrangling</h1>
  <p class="subtitle"></p><p>Julius-Maximilians-University Würzburg<br>
Course: “Biostatistics”<br>
Translational Neuroscience</p><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt) 
</div>
</div>
</div>

</section>
<section>
<section id="data-wrangling" class="title-slide slide level1 center">
<h1>Data Wrangling?</h1>
<div class="cell">
<style type="text/css">
code.sourceCode {
  font-size: 1.4em;
}

div.cell-output-stdout {
  font-size: 1.4em;
}
</style>
</div>
<aside class="notes">
<p>start recording!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p>“Preparation” of the data for analysis: cleaning up variables (outliers, erroneous values, recoding…), changing the structure/format of data frames, merging/joining data sets, calculating new variables, reducing/summarizing variables…</p>
<div class="fragment">
<p>You will spend a lot more time wrangling the data than analyzing it!</p>
</div>
<div class="fragment">
<p>You could do this manually (e.g.&nbsp;in Excel), but this is tedious, error prone &amp; not reproducible! (+ Datasets can be huge!)</p>
</div>
<div class="fragment">
<p>Fortunately, it is easy to do in R</p>
</div>
</section>
<section id="accessing-variablescolumns" class="slide level2">
<h2>Accessing Variables/Columns</h2>
<p>When wrangling your data in R, you often want to access/use different columns, e.g.&nbsp;to calculate new ones. There are a number of ways you can do that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># create a small data set for this example:</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>testdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),  <span class="co"># c() creates a (column)vector!</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>                       <span class="at">b =</span> <span class="fu">c</span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>),</span>
<span id="cb1-4"><a href="#cb1-4"></a>                       <span class="at">c =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>),</span>
<span id="cb1-5"><a href="#cb1-5"></a>                       <span class="at">d =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>),</span>
<span id="cb1-6"><a href="#cb1-6"></a>                       <span class="at">e =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>))</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">print</span>(testdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a b c d  e
1 1 a 4 7 10
2 2 b 5 8 11
3 3 c 6 9 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">str</span>(testdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3 obs. of  5 variables:
 $ a: num  1 2 3
 $ b: chr  "a" "b" "c"
 $ c: num  4 5 6
 $ d: num  7 8 9
 $ e: num  10 11 12</code></pre>
</div>
</div>
<aside class="notes">
<p>data.frame() = function to create a data.frame, which is what holds a data set! (tibbles..)</p>
<p>c() = function to make a vector. A vector is just like one single column of a data frame: It can hold several values, but all of the same type.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="accessing-variablescolumns-2" class="slide level2">
<h2>Accessing Variables/Columns 2</h2>
<p>When wrangling your data in R, you often want to access/use different columns, e.g.&nbsp;to calculate new ones. There are a number of ways you can do that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># in baseR, we access elements of a data.frame with square brackets</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>testdata[<span class="dv">1</span>, <span class="dv">2</span>] <span class="co">#get cell that is in first row and second column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>testdata[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="co">#use a colon to create ranges of values: first two rows and column numbers 4 and 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  d  e
1 7 10
2 8 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># we can leave one part empty to select ALL available columns/rows</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>testdata[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,] <span class="co">#first two rows, all columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a b c d  e
1 1 a 4 7 10
2 2 b 5 8 11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>testdata[, <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>] <span class="co">#columns number 4 and 5, all rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  d  e
1 7 10
2 8 11
3 9 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># it is usually better to access columns by their column name:</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>testdata[, <span class="fu">c</span>(<span class="st">"d"</span>, <span class="st">"e"</span>)] <span class="co">#columns with names "d" and "e", all rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  d  e
1 7 10
2 8 11
3 9 12</code></pre>
</div>
</div>
<aside class="notes">
<p>subsetting: rows, columns –&gt; leave empty!<br>
Select range!<br>
Use either name or index of column!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="accessing-variablescolumns-3" class="slide level2">
<h2>Accessing Variables/Columns 3</h2>
<p>When wrangling your data in R, you often want to access/use different columns, e.g.&nbsp;to calculate new ones. There are a number of ways you can do that:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># access a column only:</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>testdata[, <span class="st">"a"</span>] <span class="co">#if possible, R will give you just a vector instead of a data.frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>testdata<span class="sc">$</span>a <span class="co">#short notation to get column "a" as a vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># tidy versions (see next slides)</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#library(tidyverse) #load tidyverse (if not already done)</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="fu">pull</span>(testdata, a) <span class="co">#same as testdata$a but can be used better in pipes (see next slide)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">select</span>(testdata, a) <span class="co">#get column(s) as a data.frame (we usually want this only if we select several columns)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a
1 1
2 2
3 3</code></pre>
</div>
</div>
<aside class="notes">
<p>data.frame() = function to create a data.frame, which is what holds a data set! (tibbles..)</p>
<p>c() = function to make a vector. A vector is just like one single column of a data frame: It can hold several values, but all of the same type.</p>
<p>subsetting: rows, columns –&gt; leave empty!<br>
Select range!<br>
Use either name or index of column!</p>
<p>select –&gt; tidyverse</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="tidyverse" class="title-slide slide level1 center">
<h1>Tidyverse</h1>
<p>You can do all data wrangling in Base R, i.e.&nbsp;without loading any packages. However, there’s a neat collection of packages called <strong>tidyverse</strong>, which makes data wrangling even easier!</p>
</section>
<section id="tidyverse-2" class="slide level2">
<h2>Tidyverse 2</h2>
<p>Base R:</p>
<p><code>output_data1 &lt;- function1(data)</code></p>
<p><code>output_data2 &lt;- function2(output_data1, param1)</code></p>
<p><code>output_data3 &lt;- function3(output_data2, param2, param3)</code></p>
<div class="fragment">
<p>Or:</p>
<p><code>output_data &lt;- function3(function2(function1(data), param1), param2, param3)</code></p>
</div>
<div class="fragment">
<p>Tidyverse:</p>
<p><code>output_data &lt;- data %&gt;% function1() %&gt;% function2(param1) %&gt;% function3(param2, param3)</code></p>
</div>
<div class="fragment">
<p>You can insert a pipe <code>%&gt;%</code> (including spaces) by pressing <code>Ctrl + Shift + M</code></p>

<aside class="notes">
<p>Be aware, though, that coding in the tidyverse style is very different than in Base R!</p>
<p>Base R is more similar to “traditional” programming and other programming languages.<br>
For example, you could wrap functions, which would then be carried out from the most nested to the outer function:<br>
<code>output_data &lt;- function3(function2(function1(data)))</code></p>
<p><code>function1()</code> will be carried out first, followed by <code>function2()</code>, then <code>function3()</code> .</p>
<p>. . .</p>
<p>In the tidyverse, the same would look like this:</p>
<p><code>output_data &lt;- data %&gt;% function1() %&gt;% function2() %&gt;% function(3)</code></p>
<p><code>%&gt;%</code> is called “the pipe” and will “hand over” whatever has been done to the next part. In this example, the <code>data</code> is handed over to <code>function1()</code>, which is then carried out, the result of which is handed over to <code>function2()</code> etc.</p>
<p>Tidyverse style programming is thus a bit easier to read!</p>
<p>There’s also the new pipe Base R |&gt;, which is similar to %&gt;%.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
<aside><div>
<p><code>%&gt;%</code> is called the <em>pipe</em>. It takes the output of whatever happens to its left and “hands it over” to the right. There’s also a new base-R-pipe: <code>|&gt;</code>. It is very similar, but sometimes the functionality differs.</p>
</div></aside></section>
<section id="tidyverse-3" class="slide level2">
<h2>Tidyverse 3</h2>
<p><code>library(tidyverse)</code> will load a number of packages, such as <em>dplyr</em>, <em>ggplot2</em>, <em>readr</em>, <em>forcats</em>, <em>tibble</em> etc., which are all usefuls for data wrangling.</p>
<p>We will work mainly with functions from the <em>dplyr</em> package, but also use <em>readr</em> to read in data. We will also use <em>ggplot2</em> to visualize data.</p>
<p>The most important dplyr functions for data wrangling are:</p>
<table>
<colgroup>
<col style="width: 26%">
<col style="width: 73%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>select()</td>
<td>Include or exclude certain <em>columns</em> (variables)</td>
</tr>
<tr class="even">
<td>filter()</td>
<td>Include or exclude certain <em>rows</em> (observations)</td>
</tr>
<tr class="odd">
<td>mutate()</td>
<td>Create new columns (variables)</td>
</tr>
<tr class="even">
<td>summarize()</td>
<td>Create new columns that aggregate data/create summary variables for groups of observations (data frame will become smaller)</td>
</tr>
<tr class="odd">
<td>group_by()</td>
<td>Organize the rows (observations) into groups</td>
</tr>
<tr class="even">
<td>arrange()</td>
<td>Change the order of rows (observations)</td>
</tr>
</tbody>
</table>
<aside class="notes">
<p>function names very self-explanatory!</p>
<p>We don’t create new observations in R - this is job of the data acquisition - we just read the existing data</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="wrangling-babynames" class="title-slide slide level1 center">
<h1>Wrangling Babynames</h1>
<p>This is <em>Data wrangling 1</em> of our QuantFun book: <a href="https://psyteachr.github.io/quant-fun-v2/data-wrangling-1.html" class="uri">https://psyteachr.github.io/quant-fun-v2/data-wrangling-1.html</a></p>
</section>
<section id="setting-up-libraries" class="slide level2">
<h2>Setting up libraries</h2>
<ol type="1">
<li><p>Open your Biostats R project.</p></li>
<li><p>Create a new R script and save it, e.g.&nbsp;as “<code>DataWrangling1.R</code>”.</p></li>
<li><p>Insert code to make sure the packages “<code>tidyverse</code>” and “<code>babynames</code>” are installed and loaded.</p></li>
</ol>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># install.packages("tidyverse")</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co"># install.packages("babynames")</span></span>
<span id="cb23-3"><a href="#cb23-3"></a></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="fu">library</span>(babynames)</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>load tidyverse last, otherwise functions with same name will be masked from package that is loaded first. Since we often need tidyverse functions, it’s safest to load it last!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="look-at-the-data" class="slide level2">
<h2>Look at the Data</h2>
<div>
<ol type="1">
<li class="fragment"><p>Type the word <code>babynames</code> into your console pane and press enter. What kind of information do you get?</p>
<ul>
<li class="fragment"><p>“A tibble: 1,924,665 x 5”</p>
<ul>
<li class="fragment"><p>tibble is an extension of the data.frame with more convenient output (e.g., values rounded to significant digits)</p></li>
<li class="fragment"><p>~1.9 million rows/observations</p></li>
<li class="fragment"><p>5 columns/variables</p></li>
</ul></li>
</ul></li>
<li class="fragment"><p>What kind of columns/variables do we have?</p>
<ul>
<li class="fragment"><p>dbl = double/numeric (can take decimals)</p></li>
<li class="fragment"><p>chr = character/string (letters or words)</p></li>
<li class="fragment"><p>int = integer (only whole numbers)</p></li>
</ul></li>
</ol>
</div>
<aside class="notes">
<p>ask first for 1 and 2</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="selecting-variables-of-interest" class="slide level2">
<h2>Selecting Variables of Interest</h2>
<p>Use <code>select()</code> to choose only the columns <code>year</code>, <code>sex</code>, <code>name</code>, and <code>prop</code> and store it as a new tibble called <code>babynames_reduced</code>.<br>
Remember that you can run <code>?select</code> in the console if you need help about, e.g., input/arguments to the function.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># my favorite:</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>babynames_reduced <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">select</span>(year, sex, name, prop)</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># or without the pipe operator:</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>babynames_reduced <span class="ot">&lt;-</span> <span class="fu">select</span>(<span class="at">.data =</span> babynames, year, sex, name, prop)</span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co"># or alternatively:</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>babynames_reduced <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> </span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="fu">select</span>(<span class="sc">-</span>n) <span class="co"># remove columns by using -</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Removing columns vs.&nbsp;selecting columns: Results may change if the data get updated!</p>
</div>
</section>
<section id="arranging-data" class="slide level2">
<h2>Arranging Data</h2>
<p>Change the order of the data (oberservations/rows)!</p>
<div>
<ol type="1">
<li class="fragment">Using <code>arrange()</code>, try sorting the data according to the <code>names</code> column. What happens?</li>
<li class="fragment">How can you sort a column in a descending fashion? Check out the help file (<code>?arrange</code>).</li>
<li class="fragment">Let’s sort by year descendingly and within each year, sort names alphabetically.</li>
</ol>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>sort_asc <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(name)</span>
<span id="cb25-2"><a href="#cb25-2"></a></span>
<span id="cb25-3"><a href="#cb25-3"></a>sort_desc <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(year)) </span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a>babynames <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(year), name) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,924,665 × 5
    year sex   name          n       prop
   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;      &lt;dbl&gt;
 1  2017 M     Aaban        11 0.0000056 
 2  2017 F     Aabriella     6 0.0000032 
 3  2017 M     Aadam        18 0.00000917
 4  2017 M     Aadan         8 0.00000407
 5  2017 M     Aadarsh      15 0.00000764
 6  2017 M     Aaden       240 0.000122  
 7  2017 M     Aadesh        7 0.00000357
 8  2017 M     Aadhav       31 0.0000158 
 9  2017 M     Aadhavan      6 0.00000306
10  2017 M     Aadhi        10 0.00000509
# ℹ 1,924,655 more rows</code></pre>
</div>
</div>
<aside class="notes">
<p>remember to save data in new tibble/data frame!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="filter-observations" class="slide level2">
<h2>Filter Observations</h2>
<p>We have already used <code>select()</code> to keep only certain <em>variables</em> (columns), but often we also want to keep only certain <em>observations</em> (rows), e.g.&nbsp;babies born in the year 2000 and later.</p>
<p>We use the function <code>filter()</code> for this.</p>
<div class="fragment">
<p>Look at the following code and think about what it might do.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>babynames <span class="sc">%&gt;%</span> <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">2000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 562,156 × 5
    year sex   name          n    prop
   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;   &lt;dbl&gt;
 1  2001 F     Emily     25055 0.0127 
 2  2001 F     Madison   22164 0.0112 
 3  2001 F     Hannah    20712 0.0105 
 4  2001 F     Ashley    16526 0.00835
 5  2001 F     Alexis    16401 0.00828
 6  2001 F     Sarah     15896 0.00803
 7  2001 F     Samantha  15862 0.00801
 8  2001 F     Abigail   14807 0.00748
 9  2001 F     Elizabeth 14784 0.00747
10  2001 F     Olivia    13978 0.00706
# ℹ 562,146 more rows</code></pre>
</div>
</div>
<p>The data starts at 2001! :(</p>
</div>
</section>
<section id="detour-boolean-expressions" class="slide level2">
<h2>Detour: Boolean Expressions</h2>
<p>The second argument, <code>year &gt; 2000</code>, is a <em>Boolean</em> or <em>logical expression</em>, which means that it results in a value of either TRUE or FALSE. <code>filter()</code> runs this expression and then removes all values/rows that contain FALSE.</p>
<p>There are also other Boolean expressions:</p>
<table>
<caption>Boolean expressions</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 26%">
<col style="width: 48%">
</colgroup>
<thead>
<tr class="header">
<th>Operator</th>
<th>Name</th>
<th>is TRUE if and only if</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A &lt; B</td>
<td>less than</td>
<td>A is less than B</td>
</tr>
<tr class="even">
<td>A &lt;= B</td>
<td>less than or equal</td>
<td>A is less than or equal to B</td>
</tr>
<tr class="odd">
<td>A &gt; B</td>
<td>greater than</td>
<td>A is greater than B</td>
</tr>
<tr class="even">
<td>A &gt;= B</td>
<td>greater than or equal</td>
<td>A is greater than or equal to B</td>
</tr>
<tr class="odd">
<td>A == B</td>
<td>equivalence</td>
<td>A exactly equals B</td>
</tr>
<tr class="even">
<td>A != B</td>
<td>not equal</td>
<td>A does not exactly equal B</td>
</tr>
<tr class="odd">
<td>A %in% B</td>
<td>in</td>
<td>A is an element of <u>vector</u> B</td>
</tr>
</tbody>
</table>

<aside><div>
<p>A double equality sign <code>==</code> is a comparison, a single equals <code>=</code> is a variable or parameter assignment.<br>
This is why R users like to make the distinction even bigger by using <code>&lt;-</code> for variable assignment (your environment in the top right pane) and <code>=</code> for parameter assignment in functions (a hidden so-called <em>local</em> environment only visible to the function).</p>
</div></aside></section>
<section id="filter-some-more" class="slide level2">
<h2>Filter some more</h2>
<ol type="1">
<li>Keep only those observations with the name “Mary”.</li>
<li>Discard all observations with name “Mary” and keep only those from year &gt; 2000.</li>
<li>Keep only those with names of former Queens (Mary, Elizabeth, Victoria).</li>
<li>Discard the ones with the Queen names!</li>
</ol>
<div class="fragment">
<p>First task:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>marys <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">"Mary"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>The second task might be difficult because you have two expressions, <code>name != "Mary"</code> and <code>year &gt; 2000</code>. You can simply add several expressions separated by commas in filter (commas are treated like a “logical and” <code>&amp;</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>no_marys_young <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">!=</span> <span class="st">"Mary"</span>, year <span class="sc">&gt;</span> <span class="dv">2000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Third task:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>queens <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Mary"</span>, <span class="st">"Elizabeth"</span>, <span class="st">"Victoria"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>The fourth task is tricky! You could use three filters in a row with <code>name != "Mary", name != "Elizabeth", name != "Victoria"</code>. Or you could use <code>%in%</code>, but then you can’t use the <code>!</code> in front of the <code>%in%</code>. The trick is to negate the whole expression with <code>== FALSE</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>no_queens <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Mary"</span>, <span class="st">"Elizabeth"</span>, <span class="st">"Victoria"</span>) <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="your-first-plot" class="slide level2">
<h2>Your First Plot</h2>
<p>In your script, insert and run the following code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>dat <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">filter</span>(sex<span class="sc">==</span><span class="st">"F"</span>, <span class="co">#only female babies</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>         name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Emily"</span>, <span class="st">"Kathleen"</span>, <span class="st">"Alexandra"</span>, <span class="st">"Beverly"</span>)) <span class="co">#reduce to these 4 names</span></span>
<span id="cb33-4"><a href="#cb33-4"></a></span>
<span id="cb33-5"><a href="#cb33-5"></a>dat <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> prop, <span class="at">colour =</span> name)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">2</span>) <span class="co">#plot data as a line (with increased size)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="W3_DataWranglingR_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"><div class="fragment">
<p>Alter the code to check for male babies with the same names (change <code>sex=="F"</code> to <code>sex=="M"</code>).<br>
<em>Optional</em>: Plot the absolute number <code>n</code> instead of the relative proportion <code>prop</code>.</p>
</div>
</section>
<section id="create-new-variables" class="slide level2">
<h2>Create New Variables</h2>
<p>If we want to create variables that do not exist yet (i.e.&nbsp;by calculating values, combining other variables, etc.), we can use <code>mutate()</code>!</p>
<ol type="1">
<li>Add a variable called “country” that contains the value “USA” for all observations</li>
</ol>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>baby_where <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">country =</span> <span class="st">"USA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>But <code>mutate</code> is much more powerful and can create variables that differ per observation, depending on other values in the tibble/data frame:</p>
<ol start="2" type="1">
<li>Create a variable that denotes the decade a baby was born:</li>
</ol>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co">#we can only use floor to round down to full numbers =&gt; divide year by 10, floor it, and then multiply by 10 again</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>baby_decades <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(year<span class="sc">/</span><span class="dv">10</span>) <span class="sc">*</span><span class="dv">10</span>) <span class="co">#round(year, -1) works but not floor(year, -1) :(</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
    year decade
   &lt;dbl&gt;  &lt;dbl&gt;
 1  1899   1890
 2  1900   1900
 3  1928   1920
 4  1930   1930
 5  1931   1930
 6  1947   1940
 7  1972   1970
 8  1973   1970
 9  2001   2000
10  2014   2010</code></pre>
</div>
</div>
</div>
</section>
<section id="summarizing" class="slide level2">
<h2>Summarizing</h2>
<p>The goal of data wrangling is often to summarize (or aggregate) the data, e.g.&nbsp;to have an average value per condition. Sometimes you’d also want to calculate descriptive statistics to report.</p>
<div class="fragment">
<p>You can do so using the function <code>summarise()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># run the filter function just like above again:</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>dat <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Emily"</span>, <span class="st">"Kathleen"</span>, <span class="st">"Alexandra"</span>, <span class="st">"Beverly"</span>), </span>
<span id="cb37-4"><a href="#cb37-4"></a>         sex <span class="sc">==</span> <span class="st">"F"</span>)</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a><span class="co"># summarize the data, calculating the number of oberservations:</span></span>
<span id="cb37-7"><a href="#cb37-7"></a>dat_sum <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n))</span>
<span id="cb37-8"><a href="#cb37-8"></a>dat_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
    total
    &lt;int&gt;
1 2161374</code></pre>
</div>
</div>
<p>As you can see, a new variable named total is created, which contains the total number of observations (in this case, it is different from the number of rows because each row already contains a count <code>n</code>).<br>
There’s just one row in the resulting data frame, because <code>summarise()</code> reduces the data frame (to only include the necessary information)!</p>
</div>
</section>
<section id="grouping-and-summarizing" class="slide level2">
<h2>Grouping and Summarizing</h2>
<p>Often, we want to summarize data for specific subgroups. For this aim, <code>summarise()</code> has the <code>.by</code> parameter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>group_sum <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.by=</span>name) </span>
<span id="cb39-2"><a href="#cb39-2"></a>group_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  name       total
  &lt;chr&gt;      &lt;int&gt;
1 Emily     841491
2 Kathleen  711605
3 Beverly   376914
4 Alexandra 231364</code></pre>
</div>
</div>
<div class="fragment">
<p>You can also subgroup by a combination of variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>babynames <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Emily"</span>, <span class="st">"Kathleen"</span>, <span class="st">"Alexandra"</span>, <span class="st">"Beverly"</span>)) <span class="sc">%&gt;%</span> <span class="co">#we start with the 4 names regardless of sex</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.by=</span><span class="fu">c</span>(name, sex)) <span class="co">#and then summarise by name, separated for sex</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  name      sex    total
  &lt;chr&gt;     &lt;chr&gt;  &lt;int&gt;
1 Emily     F     841491
2 Kathleen  F     711605
3 Beverly   M       4633
4 Beverly   F     376914
5 Alexandra F     231364
6 Emily     M       1744
7 Kathleen  M       1692
8 Alexandra M        859</code></pre>
</div>
</div>
</div>
</section>
<section id="grouping-and-summarizing-2" class="slide level2">
<h2>Grouping and Summarizing 2</h2>
<p>In earlier versions, we had to use <code>summarise()</code> together with <code>group_by()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>group_sum <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) </span>
<span id="cb43-2"><a href="#cb43-2"></a>group_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  name       total
  &lt;chr&gt;      &lt;int&gt;
1 Alexandra 231364
2 Beverly   376914
3 Emily     841491
4 Kathleen  711605</code></pre>
</div>
</div>
<p>We avoid using <code>group_by()</code> because it can have unintended side effects.<br>
It is just part of this class because you will likely encounter it in somebody else’s (old) code.<br>
<br>
If you do have to use it, make sure to <code>ungroup()</code> after <code>summarise()</code> (or <code>mutate()</code>) to avoid unintended effects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>group_sum <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ## Ungrouping

Remember that the grouping done with `group_by()` is saved with the data frame (even though it might not immediately be obvious).

It is good practice to always `ungroup()` your data once you finished the operations you needed the grouping for!


::: {.cell}

```{.r .cell-code  code-line-numbers="8"}
babynames %>% 
   filter(name %in% c("Emily",
                     "Kathleen",
                     "Alexandra",
                     "Beverly"), sex=="F") %>%
  group_by(name) %>% 
  summarise(n = n()) %>% 
  ungroup()
```

::: {.cell-output .cell-output-stdout}
```
# A tibble: 4 × 2
  name          n
  <chr>     <int>
1 Alexandra   117
2 Beverly     122
3 Emily       138
4 Kathleen    138
```
:::
:::

-->
</section>
<section id="grouping-and-summarizing-3" class="slide level2">
<h2>Grouping and Summarizing 3</h2>
<p>Use the <code>baby_decades</code> data frame to calculate the mean and median number of observations, grouped by sex &amp; decade.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>baby_decades <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean_year =</span> <span class="fu">mean</span>(n),</span>
<span id="cb46-2"><a href="#cb46-2"></a>                           <span class="at">median_year =</span> <span class="fu">median</span>(n),</span>
<span id="cb46-3"><a href="#cb46-3"></a>                           <span class="at">.by=</span><span class="fu">c</span>(sex, decade))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 4
   sex   decade mean_year median_year
   &lt;chr&gt;  &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1 F       1880     111.           13
 2 M       1880     101.           12
 3 F       1890     128.           13
 4 M       1890      93.6          12
 5 F       1900     131.           12
 6 M       1900      94.4          12
 7 F       1910     187.           12
 8 M       1910     181.           12
 9 F       1920     211.           12
10 M       1920     227.           13
# ℹ 18 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="counting-data" class="slide level2">
<h2>Counting Data</h2>
<p>There are several ways to get the number of rows per group. You can use the function <code>n()</code> within a call to <code>summarise()</code> (or <code>mutate()</code>). A shortcut is to use <code>count()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.by=</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  name          n
  &lt;chr&gt;     &lt;int&gt;
1 Emily       138
2 Kathleen    138
3 Beverly     122
4 Alexandra   117</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>dat <span class="sc">%&gt;%</span> <span class="fu">count</span>(name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  name          n
  &lt;chr&gt;     &lt;int&gt;
1 Alexandra   117
2 Beverly     122
3 Emily       138
4 Kathleen    138</code></pre>
</div>
</div>
<p>Interestingly, the order of the output may vary. <code>summarise()</code> leaves the data in the original order (i.e., by <code>prop</code>, which (likely) translates to an order by <code>n()</code>). <code>count()</code> arranges the output by the variables for which the counting is done (here: alphabetically by <code>name</code>).</p>
</section>
<section id="bigger-pipes" class="slide level2">
<h2>Bigger Pipes!</h2>
<p>So far we have often saved intermediate steps in tibbles and used those as input for the next function. With the pipe, we can chain several functions and save relevant results only, no need for crowding the environment with intermediate data.frames or tibbles!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>pipe_summary <span class="ot">&lt;-</span> babynames <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> <span class="fu">floor</span>(year<span class="sc">/</span><span class="dv">10</span>) <span class="sc">*</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="fu">filter</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Emily"</span>, <span class="st">"Kathleen"</span>, <span class="st">"Alexandra"</span>, <span class="st">"Beverly"</span>), </span>
<span id="cb52-4"><a href="#cb52-4"></a>         sex<span class="sc">==</span><span class="st">"F"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5"></a>  <span class="fu">summarise</span>(<span class="at">mean_decade =</span> <span class="fu">mean</span>(n), <span class="at">.by=</span><span class="fu">c</span>(name, decade))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s not easy to decide which intermediate steps to save and which not. Usually, it involves some sort of trial and error. Sometimes you go back and break a pipe apart. Sometimes you get overwhelmed by the number of variables in your environment and create bigger pipes.<br>
As a rule of thumb: If an intermediate step is only used <strong>once</strong>, you should probably delete it (unless it makes the code easier to comprehend).</p>
</section></section>
<section>
<section id="more-serious-data-wrangling" class="title-slide slide level1 center">
<h1>More serious Data Wrangling</h1>
<p>This is <em>Data wrangling 3</em> of our QuantFun book: <a href="https://psyteachr.github.io/quant-fun-v2/data-wrangling-3.html" class="uri">https://psyteachr.github.io/quant-fun-v2/data-wrangling-3.html</a><br>
</p>
<p>We will skip <em>Data wrangling 2</em> here but you will find the solutions in the end of the slides.</p>
</section>
<section id="tidy-data" class="slide level2">
<h2>Tidy Data</h2>
<p>Tidy data: Data that is easily processed by tidyverse functions (also for visualizations and statistical analyses).</p>
<p>Three principles:</p>
<ul>
<li><p>Each variable has its own column.</p></li>
<li><p>Each observation has its own row.</p></li>
<li><p>Each value has its own cell.</p></li>
</ul>
<div class="fragment">
<p>Wide vs.&nbsp;long format data?</p>
<div class="columns">
<div class="column">
<p>Wide format: Each participant/animal has one row;<br>
repeated observations are in several columns</p>
<table>
<thead>
<tr class="header">
<th>ID</th>
<th>Time_1</th>
<th>Time_2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>230</td>
<td>310</td>
</tr>
<tr class="even">
<td>a2</td>
<td>195</td>
<td>220</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>245</td>
<td>290</td>
</tr>
</tbody>
</table>
</div><div class="column">
<p>Long format: Each observation has its own row;<br>
there are (usually) several rows per participant</p>
<table>
<thead>
<tr class="header">
<th>ID</th>
<th>Time</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>a1</td>
<td>1</td>
<td>230</td>
</tr>
<tr class="even">
<td>a1</td>
<td>2</td>
<td>310</td>
</tr>
<tr class="odd">
<td>a2</td>
<td>1</td>
<td>195</td>
</tr>
<tr class="even">
<td>a3</td>
<td>2</td>
<td>220</td>
</tr>
<tr class="odd">
<td>a3</td>
<td>1</td>
<td>245</td>
</tr>
<tr class="even">
<td>a3</td>
<td>2</td>
<td>290</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="fragment">
<p>Wide format implements a sparser representation of the data but less tidy!<br>
If you want to convert <code>Time</code> from milliseconds into seconds, what do you have to do in both formats?</p>
<aside class="notes">
<p>Data often does not come in this format but is rather messy! That’s why we wrangle.</p>
<p>Tidy data is in between wide and long (you can always go longer! :D)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="tidy-data-2" class="slide level2">
<h2>Tidy Data 2</h2>
<p>What do you think, which of the following data sets is tidy?</p>
<div class="columns">
<div class="column" style="width:40%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country      year type            count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;
 1 Afghanistan  1999 cases             745
 2 Afghanistan  1999 population   19987071
 3 Afghanistan  2000 cases            2666
 4 Afghanistan  2000 population   20595360
 5 Brazil       1999 cases           37737
 6 Brazil       1999 population  172006362
 7 Brazil       2000 cases           80488
 8 Brazil       2000 population  174504898
 9 China        1999 cases          212258
10 China        1999 population 1272915272
11 China        2000 cases          213766
12 China        2000 population 1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country      year  cases population
  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan  1999    745   19987071
2 Afghanistan  2000   2666   20595360
3 Brazil       1999  37737  172006362
4 Brazil       2000  80488  174504898
5 China        1999 212258 1272915272
6 China        2000 213766 1280428583</code></pre>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column" style="width:35%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  country      year rate             
  &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;            
1 Afghanistan  1999 745/19987071     
2 Afghanistan  2000 2666/20595360    
3 Brazil       1999 37737/172006362  
4 Brazil       2000 80488/174504898  
5 China        1999 212258/1272915272
6 China        2000 213766/1280428583</code></pre>
</div>
</div>
</div><div class="column" style="width:65%;">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  country     `1999_cases` `2000_cases` `1999_population` `2000_population`
  &lt;chr&gt;              &lt;dbl&gt;        &lt;dbl&gt;             &lt;dbl&gt;             &lt;dbl&gt;
1 Afghanistan          745         2666          19987071          20595360
2 Brazil             37737        80488         172006362         174504898
3 China             212258       213766        1272915272        1280428583</code></pre>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Table1 is tidy! (upper)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="analyzing-the-autism-spectrum-quotient" class="slide level2">
<h2>Analyzing the Autism Spectrum Quotient</h2>
<p>For the following activities, we will need the following files:</p>
<ul>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/responses.csv">responses.csv</a> containing the AQ survey responses to each of the 10 questions for the 66 participants</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/qformats.csv">qformats.csv</a> containing information on how a question should be coded - i.e.&nbsp;forward or reverse coding</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/scoring.csv">scoring.csv</a> containing information on how many points a specific response should get; depending on whether it is forward or reverse coded</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/pinfo.csv">pinfo.csv</a> containing participant information such as <code>Age</code>, <code>Sex</code> and importantly <code>ID</code> number.</p></li>
</ul>
</section>
<section id="set-up" class="slide level2">
<h2>Set Up</h2>
<p>For the following activities, we will need the following files:</p>
<ul>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/responses.csv">responses.csv</a> containing the AQ survey responses to each of the 10 questions for the 66 participants</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/qformats.csv">qformats.csv</a> containing information on how a question should be coded - i.e.&nbsp;forward or reverse coding</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/scoring.csv">scoring.csv</a> containing information on how many points a specific response should get; depending on whether it is forward or reverse coded</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/pinfo.csv">pinfo.csv</a> containing participant information such as <code>Age</code>, <code>Sex</code> and importantly <code>ID</code> number.</p></li>
</ul>
<ol type="1">
<li><p>Create a new script, e.g.&nbsp;as “<code>DataWrangling3.R</code>” (remember we skipped #2 in the book).</p></li>
<li><p>Download the data into your project folder.</p></li>
<li><p><em>Optional</em>: Clear your environment (the brush in the top right pane) and/or restart the R session (Session -&gt; Restart R).</p></li>
</ol>
</section>
<section id="load-the-data" class="slide level2">
<h2>Load the Data</h2>
<p>For the following activities, we will need the following files:</p>
<ul>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/responses.csv">responses.csv</a> containing the AQ survey responses to each of the 10 questions for the 66 participants</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/qformats.csv">qformats.csv</a> containing information on how a question should be coded - i.e.&nbsp;forward or reverse coding</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/scoring.csv">scoring.csv</a> containing information on how many points a specific response should get; depending on whether it is forward or reverse coded</p></li>
<li><p><a href="https://psyteachr.github.io/quant-fun-v2/pinfo.csv">pinfo.csv</a> containing participant information such as <code>Age</code>, <code>Sex</code> and importantly <code>ID</code> number.</p></li>
</ul>
<ol start="4" type="1">
<li>Load the four .csv files into your environment, e.g.:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>responses <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"responses.csv"</span>) </span>
<span id="cb57-2"><a href="#cb57-2"></a>qformats <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"qformats.csv"</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a>scoring <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"scoring.csv"</span>)</span>
<span id="cb57-4"><a href="#cb57-4"></a>pinfo <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"pinfo.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="look-at-the-data-1" class="slide level2">
<h2>Look at the Data</h2>
<p>Is the data (<code>responses</code>) in a tidy format?</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
     Id Q1                 Q2    Q3    Q4    Q5    Q6    Q7    Q8    Q9    Q10  
  &lt;dbl&gt; &lt;chr&gt;              &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
1    16 Slightly Disagree  Defi… Slig… Defi… Slig… Slig… Slig… Defi… Slig… Slig…
2    17 Definitely Agree   Slig… Slig… Defi… Defi… Defi… Slig… Slig… Slig… Slig…
3    18 Definitely Agree   Defi… Slig… Defi… Defi… Defi… Slig… Defi… Defi… Defi…
4    19 Definitely Agree   Defi… Defi… Slig… Defi… Defi… Slig… Slig… Defi… Slig…
5    20 Definitely Disagr… Slig… Defi… Slig… Slig… Slig… Slig… Slig… Slig… Slig…
6    21 Slightly Disagree  Slig… Defi… Slig… Slig… Slig… Defi… Defi… Slig… Slig…</code></pre>
</div>
</div>
<div class="fragment">
<p>Why is it not tidy?</p>
<aside class="notes">
<p>wide format</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="reformatting-the-data" class="slide level2">
<h2>Reformatting the Data</h2>
<p>Let’s bring the wide data in a longer, tidy format!</p>
<div class="fragment">
<p>There are several functions in R to reformat data, but the newest ones are <code>pivot_longer()</code> and <code>pivot_wider()</code>.</p>
<p>Run the code and see what changes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>rlong <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Q1<span class="sc">:</span>Q10, <span class="co">#we can select a range of column names</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>                                    <span class="co">#cols = starts_with("Q"), #alternative</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>                                    <span class="at">names_to =</span> <span class="st">"Question"</span>, </span>
<span id="cb59-4"><a href="#cb59-4"></a>                                    <span class="at">values_to =</span> <span class="st">"Response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Describe what the function does, what does the input/the arguments mean?</p>
</div>
</section>
<section id="joining-the-data" class="slide level2">
<h2>Joining the Data</h2>
<p>We now want to combine the different data sets: We want to have the information how the questionnaire has to be scored included with the items.</p>
<p>We can find the scoring information (i.e.&nbsp;how the questions are framed, positive or negative/whether they need to be reversed) in the <code>qformats</code> tibble. Furthermore, we can find how many points are given to each item/response in <code>scoring</code>.</p>
<p>We can use the function <code>inner_join()</code> to merge the tibbles into one bigger tibble.</p>
<div class="fragment">
<p>Activity: Replace the <code>NULL</code> values in the below code with the necessary variable names to join <code>rlong</code> and <code>qformats</code> by <code>Question</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>rlong2 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(<span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb60-2"><a href="#cb60-2"></a>                     <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb60-3"><a href="#cb60-3"></a>                     <span class="at">by =</span> <span class="st">"NULL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>rlong2 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(<span class="at">x =</span> rlong, </span>
<span id="cb61-2"><a href="#cb61-2"></a>                     <span class="at">y =</span> qformats, </span>
<span id="cb61-3"><a href="#cb61-3"></a>                     <span class="at">by =</span> <span class="st">"Question"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>Describe what happened?</p>
<p>what is forward and reverse scoring?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="combining-more-data" class="slide level2">
<h2>Combining more Data</h2>
<p>You can only join two data frames/tibbles at once.<br>
Now add the scoring data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>rscores <span class="ot">&lt;-</span> rlong2 <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(scoring, </span>
<span id="cb62-2"><a href="#cb62-2"></a>                                 <span class="fu">c</span>(<span class="st">"QFormat"</span>, <span class="st">"Response"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculate-the-questionnaire-scores" class="slide level2">
<h2>Calculate the Questionnaire Scores</h2>
<p>How do we need to group and summarize the data to get a sum score per person? (Ignoring the reverse coding for now!) Add the correct column names instead of the <code>NULL</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>aq_scores <span class="ot">&lt;-</span> rscores <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">AQ =</span> <span class="fu">sum</span>(<span class="cn">NULL</span>), <span class="at">.by=</span><span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>aq_scores <span class="ot">&lt;-</span> rscores <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">AQ =</span> <span class="fu">sum</span>(Score), <span class="at">.by=</span>Id) <span class="co"># sum column Score to obtain AQ scores.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="pipe-it-all-together" class="slide level2">
<h2>Pipe it all together!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>aq_scores2 <span class="ot">&lt;-</span> responses <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> Q1<span class="sc">:</span>Q10,</span>
<span id="cb65-3"><a href="#cb65-3"></a>               <span class="at">names_to =</span> <span class="st">"Question"</span>, </span>
<span id="cb65-4"><a href="#cb65-4"></a>               <span class="at">values_to =</span> <span class="st">"Response"</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb65-5"><a href="#cb65-5"></a>  <span class="fu">inner_join</span>(qformats, <span class="st">"Question"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-6"><a href="#cb65-6"></a>  <span class="fu">inner_join</span>(scoring, <span class="fu">c</span>(<span class="st">"QFormat"</span>, <span class="st">"Response"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-7"><a href="#cb65-7"></a>  <span class="fu">summarise</span>(<span class="at">AQ =</span> <span class="fu">sum</span>(Score), <span class="at">.by=</span>Id) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="optional-exercises" class="title-slide slide level1 center">
<h1>Optional Exercises</h1>
<p>This is <em>Data wrangling 2</em> of our QuantFun book: <a href="https://psyteachr.github.io/quant-fun-v2/data-wrangling-2.html" class="uri">https://psyteachr.github.io/quant-fun-v2/data-wrangling-2.html</a></p>
</section>
<section id="background" class="slide level2">
<h2>Background</h2>
<p>We’ll use data from a <a href="https://journals.sagepub.com/doi/full/10.1177/0956797617730892">paper</a> that investigates whether the ability to perform an action influences perception. In particular, the authors wondered whether participants who played Pong would perceive the ball to move faster when they have a small paddle.</p>
<div>
<ol type="1">
<li class="fragment"><p>Download the data, create a new script.</p></li>
<li class="fragment"><p>Clear the environment if you prefer.</p></li>
<li class="fragment"><p>Look at the data.</p></li>
</ol>
</div>
</section>
<section id="solutions" class="slide level2">
<h2>Solutions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">library</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb66-2"><a href="#cb66-2"></a>pong_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/PongBlueRedBack 1-16 Codebook.csv"</span>)</span>
<span id="cb66-3"><a href="#cb66-3"></a><span class="fu">summary</span>(pong_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Participant     JudgedSpeed      PaddleLength   BallSpeed    TrialNumber    
 Min.   : 1.00   Min.   :0.0000   Min.   : 50   Min.   :2.0   Min.   :  1.00  
 1st Qu.: 4.75   1st Qu.:0.0000   1st Qu.: 50   1st Qu.:3.0   1st Qu.: 72.75  
 Median : 8.50   Median :1.0000   Median :150   Median :4.5   Median :144.50  
 Mean   : 8.50   Mean   :0.5471   Mean   :150   Mean   :4.5   Mean   :144.50  
 3rd Qu.:12.25   3rd Qu.:1.0000   3rd Qu.:250   3rd Qu.:6.0   3rd Qu.:216.25  
 Max.   :16.00   Max.   :1.0000   Max.   :250   Max.   :7.0   Max.   :288.00  
 BackgroundColor      HitOrMiss       BlockNumber   
 Length:4608        Min.   :0.0000   Min.   : 1.00  
 Class :character   1st Qu.:0.0000   1st Qu.: 3.75  
 Mode  :character   Median :1.0000   Median : 6.50  
                    Mean   :0.6866   Mean   : 6.50  
                    3rd Qu.:1.0000   3rd Qu.: 9.25  
                    Max.   :1.0000   Max.   :12.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="co"># look at the data (can also use summary(), str(), head() etc.)</span></span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="fu">glimpse</span>(pong_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,608
Columns: 8
$ Participant     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
$ JudgedSpeed     &lt;dbl&gt; 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, …
$ PaddleLength    &lt;dbl&gt; 50, 250, 50, 250, 250, 50, 250, 50, 250, 50, 50, 250, …
$ BallSpeed       &lt;dbl&gt; 5, 3, 4, 3, 7, 5, 6, 2, 4, 4, 7, 7, 3, 6, 5, 7, 2, 5, …
$ TrialNumber     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…
$ BackgroundColor &lt;chr&gt; "red", "blue", "red", "red", "blue", "blue", "red", "r…
$ HitOrMiss       &lt;dbl&gt; 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, …
$ BlockNumber     &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</code></pre>
</div>
</div>
</section>
<section id="solutions-2" class="slide level2">
<h2>Solutions 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>new_pong_data <span class="ot">&lt;-</span> pong_data <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">select</span>(BallSpeed, HitOrMiss, JudgedSpeed, Participant, </span>
<span id="cb70-3"><a href="#cb70-3"></a>         TrialNumber) <span class="sc">%&gt;%</span> </span>
<span id="cb70-4"><a href="#cb70-4"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(HitOrMiss), <span class="fu">desc</span>(JudgedSpeed)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="#cb70-5"></a>  <span class="fu">filter</span>(JudgedSpeed <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb70-6"><a href="#cb70-6"></a>         BallSpeed <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"4"</span>, <span class="st">"5"</span>, <span class="st">"7"</span>),</span>
<span id="cb70-7"><a href="#cb70-7"></a>         HitOrMiss <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-8"><a href="#cb70-8"></a>  <span class="fu">filter</span>(TrialNumber <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb70-9"><a href="#cb70-9"></a>  <span class="fu">mutate</span>(<span class="at">TrialNumber =</span> TrialNumber <span class="sc">-</span><span class="dv">1</span>) </span>
<span id="cb70-10"><a href="#cb70-10"></a>  </span>
<span id="cb70-11"><a href="#cb70-11"></a>  <span class="co"># summarize (use old data frame because we removed variables)</span></span>
<span id="cb70-12"><a href="#cb70-12"></a>pong_data_hits <span class="ot">&lt;-</span> pong_data <span class="sc">%&gt;%</span> </span>
<span id="cb70-13"><a href="#cb70-13"></a>  <span class="fu">summarise</span>(<span class="at">total_hits =</span> <span class="fu">sum</span>(HitOrMiss, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-14"><a href="#cb70-14"></a>            <span class="at">meanhits =</span> <span class="fu">mean</span>(HitOrMiss, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb70-15"><a href="#cb70-15"></a>            <span class="at">.by=</span><span class="fu">c</span>(BackgroundColor, PaddleLength))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks!</h1>
<p>Learning objectives:</p>
<ul>
<li><p>Learn about tidyverse vs.&nbsp;base R</p></li>
<li><p>Learn and apply the six basic dplyr “verbs”</p></li>
<li><p>Learn how to join data frames</p></li>
</ul>
<p>Next week:</p>
<p>Data Visualization in R</p>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="W3_DataWranglingR_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="W3_DataWranglingR_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>