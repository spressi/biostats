<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt)">
  <title>Biostatistics - 09 Statistical Analyses in R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">09 Statistical Analyses in R</h1>
  <p class="subtitle"></p><p>Julius-Maximilians-University Würzburg<br>
Course: “Biostatistics”<br>
Translational Neuroscience</p><p></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Dr.&nbsp;Mario Reutter (slides adapted from Dr.&nbsp;Lea Hildebrandt) 
</div>
</div>
</div>

</section>
<section>
<section id="kinds-of-statistical-analyses" class="title-slide slide level1 center">
<h1>Kinds of Statistical Analyses</h1>
<p>Last session, we have heard about Chi² tests, <em>t</em>-tests, correlations, and ANOVA.</p>
<p>Today we will apply them in <code>R</code>.</p>
<div class="cell">
<style type="text/css">
code.sourceCode {
  font-size: 1.4em;
}

div.cell-output-stdout {
  font-size: 1.4em;
}
</style>
</div>
<aside class="notes">
<p>which analysis do you use when you have two categorical etc. variables?</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="set-up" class="slide level2">
<h2>Set Up</h2>
<ol type="1">
<li><p>Open RStudio and load your Biostats R project. Create a new script called <code>DataAnalysis1.R</code>.</p></li>
<li><p>Install and load new packages you’ll need:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(apa)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(confintr)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(afex)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(performance)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(pwr)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(lsr)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(report)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="activity-1" class="title-slide slide level1 center">
<h1>Activity 1</h1>
<p>Which test would you choose if you wanted to test whether a variable is differently distributed between groups? More specifically, the variable contains <strong>counts</strong>.</p>
<p>Let’s say we have tested 20 mice and want to know whether they pressed the blue, green, or red lever more often than by chance. This is how often the mice pressed each lever: Blue = 5, Green = 4, Red = 11</p>
<div class="fragment">
<p>We would run a (one-sample) <strong>Chi²-test</strong>!</p>
<p>Remember that in a Chi²-test, we would compare observed to expected counts:</p>
<p><span class="math display">\[
\chi^2 = \sum\frac{(Observed - Expected)^2}{Expected}
\]</span></p>
</div>
</section>
<section id="one-sample-chi²-test" class="slide level2">
<h2>One Sample Chi²-Test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># Input data into R</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>lever_presses <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">levers=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"blue"</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"green"</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"red"</span>, <span class="dv">11</span>))) <span class="sc">%&gt;%</span> <span class="co">#data in usual format</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  <span class="fu">count</span>(levers) <span class="co">#convert to a frequency table (most useful for tables)</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>lever_presses_wide <span class="ot">&lt;-</span> lever_presses <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">"levers"</span>, <span class="at">values_from=</span><span class="st">"n"</span>) <span class="co">#wide format (needed for chisq.test function)</span></span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># run Chi² test</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>chi2_lever <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(lever_presses_wide) </span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#chi2_lever &lt;- chisq.test(tibble(blue=5, green=4, red=11)) #enter data directly as summary table</span></span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a>chi2_lever <span class="sc">%&gt;%</span> apa<span class="sc">::</span><span class="fu">chisq_apa</span>() <span class="co">#output results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>chi^2(2) = 4.30, p = .116</code></pre>
</div>
</div>
</section>
<section id="one-sample-chi²-test-expected-values-residuals" class="slide level2">
<h2>One Sample Chi²-Test: Expected Values &amp; Residuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># add expected count and residuals to data</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>lever_presses <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">expected =</span> chi2_lever<span class="sc">$</span>expected, </span>
<span id="cb4-3"><a href="#cb4-3"></a>                         <span class="at">diff =</span> n <span class="sc">-</span> expected,</span>
<span id="cb4-4"><a href="#cb4-4"></a>                         <span class="at">residuals =</span> chi2_lever<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  levers     n expected  diff residuals
  &lt;chr&gt;  &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 blue       5     6.67 -1.67    -0.645
2 green      4     6.67 -2.67    -1.03 
3 red       11     6.67  4.33     1.68 </code></pre>
</div>
</div>
<aside class="notes">
<p>Is sample size not important for significance here? <span class="math display">\[\chi^2 = \sum\frac{(Observed - Expected)^2}{Expected}\]</span> More observations =&gt; easier to see greater absolute difference between observed and expected values =&gt; gets squared and therefore “outcompetes” denominator (what about expected reductions in sampling error?)</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="chi²-test-2" class="slide level2">
<h2>Chi²-Test 2</h2>
<p>We can also run a Chi²-test for two variables, such as if we want to know whether the lever press distributions differ between two (or more) groups.</p>
<p>Let’s say we have a treatment and a control group and we record the different lever presses:</p>
<table>
<thead>
<tr class="header">
<th>Group</th>
<th style="text-align: center;">Blue</th>
<th style="text-align: center;">Green</th>
<th style="text-align: center;">Red</th>
<th style="text-align: center;"><strong>Totals</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Treatment</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;"><strong>20</strong></td>
</tr>
<tr class="even">
<td>Control</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;"><strong>20</strong></td>
</tr>
<tr class="odd">
<td><strong>Totals</strong></td>
<td style="text-align: center;"><strong>8</strong></td>
<td style="text-align: center;"><strong>16</strong></td>
<td style="text-align: center;"><strong>16</strong></td>
<td style="text-align: center;"><strong>40</strong></td>
</tr>
</tbody>
</table>
<p>Remember: We use the assumption of independence to calculate the expected values.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>lever_presses2 <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">group=</span><span class="st">"treatment"</span>, <span class="at">blue=</span><span class="dv">3</span>, <span class="at">green=</span><span class="dv">12</span>, <span class="at">red=</span><span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(<span class="at">group=</span><span class="st">"control"</span>, <span class="at">blue=</span><span class="dv">5</span>, <span class="at">green=</span><span class="dv">4</span>, <span class="at">red=</span><span class="dv">11</span>)) <span class="co">#clearest way to manually input data</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#for long data, you create the frequency table identically to previous slide but with: count(group, levers)</span></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="fu">chisq.test</span>(lever_presses2 <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"group"</span>)) <span class="sc">%&gt;%</span> apa<span class="sc">::</span><span class="fu">chisq_apa</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>chi^2(2) = 6.75, p = .034</code></pre>
</div>
</div>
</div>
</section>
<section id="assumptions-of-chi²-tests" class="slide level2">
<h2>Assumptions of Chi²-Tests</h2>
<div>
<ul>
<li class="fragment"><p><strong>Random sample</strong></p></li>
<li class="fragment"><p><strong>Categorical variables</strong>, i.e., <strong>counts</strong> within (combinations of) groups</p></li>
<li class="fragment"><p><strong>Expected cell count</strong>: &gt;5 counts per cell</p></li>
<li class="fragment"><p><strong>Independence</strong>: Each observation is independent of the others, e.g.&nbsp;there are no repeated measurements/paired data (within-subjects data are correlated!)</p></li>
</ul>
</div>
<div class="fragment">
<p>In the case of the last analysis, we got a <em>warning</em> because the expected cell sizes were too small. In this case, it is better to use <strong>Fisher’s exact test</strong>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">fisher.test</span>(lever_presses2 <span class="sc">%&gt;%</span> <span class="fu">column_to_rownames</span>(<span class="st">"group"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  lever_presses2 %&gt;% column_to_rownames("group")
p-value = 0.04168
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="activity-2" class="title-slide slide level1 center">
<h1>Activity 2</h1>
<p>Now imagine you want to compare <em>reaction times</em> of the lever presses of the two groups of mice. You expect that those in the treatment group respond faster than those in the control group. Which statistical test would you use?</p>
<div class="fragment">
<p><em>Hint</em>: We now have two <em>independent</em> groups and a <em>continuous</em> dependent variable (reaction times).</p>
</div>
<div class="fragment">
<p>⇒ An (independent samples) <em>t</em>-test!</p>
</div>
</section>
<section id="t-test-setup" class="slide level2">
<h2><em>t</em>-test setup</h2>
<p>To run a <em>t</em>-Test, let’s first simulate data. What happens here?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">set.seed</span>(<span class="dv">31415</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>sim_data_t <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"treatment"</span>, <span class="st">"control"</span>), <span class="at">each=</span><span class="dv">20</span>),</span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="at">reaction_times =</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">400</span>, <span class="dv">100</span>), <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">450</span>, <span class="dv">100</span>))) <span class="co">#poorly documented code for practice</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-9-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="t-test-formula-notation" class="slide level2">
<h2><em>t</em>-Test: Formula Notation</h2>
<p>We can use the <em>formula</em> notation to run the <em>t</em>-test. This notation usually looks like this:<br>
<code>dependent variable ~ independent variable.</code></p>
<p>Replace the <code>NULL</code>s:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">t.test</span>(<span class="cn">NULL</span> <span class="sc">~</span> <span class="cn">NULL</span>,</span>
<span id="cb11-2"><a href="#cb11-2"></a>       <span class="at">data =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-3"><a href="#cb11-3"></a>       <span class="at">alternative =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-4"><a href="#cb11-4"></a>       <span class="at">paired =</span> <span class="cn">NULL</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="t-test-formula-notation-1" class="slide level2">
<h2><em>t</em>-Test: Formula Notation</h2>
<p>We can use the <em>formula</em> notation to run the <em>t</em>-test. This notation usually looks like this:<br>
<code>dependent variable ~ independent variable.</code></p>
<p>Replace the <code>NULL</code>s:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">t.test</span>(reaction_times <span class="sc">~</span> group,</span>
<span id="cb12-2"><a href="#cb12-2"></a>       <span class="at">data =</span> sim_data_t,</span>
<span id="cb12-3"><a href="#cb12-3"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="co">#depends on ALPHABETICAL order of groups in data! (if not coded as factor)</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>       <span class="co">#paired = FALSE # this is the default, so no need to specify it</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  reaction_times by group
t = 1.9841, df = 34.42, p-value = 0.02763
alternative hypothesis: true difference in means between group control and group treatment is greater than 0
95 percent confidence interval:
 10.02639      Inf
sample estimates:
  mean in group control mean in group treatment 
               468.0592                400.3289 </code></pre>
</div>
</div>
</section>
<section id="t-test-formula-notation-2" class="slide level2">
<h2><em>t</em>-Test: Formula Notation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">t.test</span>(reaction_times <span class="sc">~</span> group,</span>
<span id="cb14-2"><a href="#cb14-2"></a>       <span class="at">data =</span> sim_data_t,</span>
<span id="cb14-3"><a href="#cb14-3"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="co">#depends on ALPHABETICAL order of groups in data! (if not coded as factor)</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>       <span class="co">#paired = FALSE # this is the default, so no need to specify it</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  reaction_times by group
t = 1.9841, df = 34.42, p-value = 0.02763
alternative hypothesis: true difference in means between group control and group treatment is greater than 0
95 percent confidence interval:
 10.02639      Inf
sample estimates:
  mean in group control mean in group treatment 
               468.0592                400.3289 </code></pre>
</div>
</div>
<p>As you can see in the output, R automatically chose to run Welch’s <em>t</em>-test, which does not assume <strong>homogeneity of variance</strong> in contrast to Student’s <em>t</em>-test. For the latter, you can add the function parameter <code>var.equal = TRUE</code></p>
<aside class="notes">
<p>When changing the name “treatment” to “a”, the results change:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">t.test</span>(reaction_times <span class="sc">~</span> group,</span>
<span id="cb16-2"><a href="#cb16-2"></a>       <span class="at">data =</span> sim_data_t <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(group<span class="sc">==</span><span class="st">"treatment"</span>, <span class="st">"a"</span>, group)),</span>
<span id="cb16-3"><a href="#cb16-3"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="co">#depends on order of groups in data! 1st group &gt; 2nd group</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> apa<span class="sc">::</span><span class="fu">t_apa</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>t(38) = -1.98, p = .973, d = -0.63</code></pre>
</div>
</div>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="t-test-with-filter" class="slide level2">
<h2><em>t</em>-Test with filter</h2>
<p>You can also supply two vectors of numerical values for the groups:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> sim_data_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"treatment"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(reaction_times),</span>
<span id="cb18-2"><a href="#cb18-2"></a>       <span class="at">y =</span> sim_data_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"control"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(reaction_times),</span>
<span id="cb18-3"><a href="#cb18-3"></a>       <span class="at">alternative =</span> <span class="st">"less"</span>) <span class="co">#more intuitive now because you can filter for treatment first</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  sim_data_t %&gt;% filter(group == "treatment") %&gt;% pull(reaction_times) and sim_data_t %&gt;% filter(group == "control") %&gt;% pull(reaction_times)
t = -1.9841, df = 34.42, p-value = 0.02763
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
      -Inf -10.02639
sample estimates:
mean of x mean of y 
 400.3289  468.0592 </code></pre>
</div>
</div>
</section>
<section id="t-test-apa-package" class="slide level2">
<h2><em>t</em>-Test: apa package</h2>
<p>More useful output with <code>apa</code> package (only for Student’s <em>t</em>-tests):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" data-code-line-numbers="4-5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> sim_data_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"treatment"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(reaction_times),</span>
<span id="cb20-2"><a href="#cb20-2"></a>       <span class="at">y =</span> sim_data_t <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group<span class="sc">==</span><span class="st">"control"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(reaction_times),</span>
<span id="cb20-3"><a href="#cb20-3"></a>       <span class="at">alternative =</span> <span class="st">"less"</span>, </span>
<span id="cb20-4"><a href="#cb20-4"></a>       <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5"></a>  apa<span class="sc">::</span><span class="fu">t_apa</span>(<span class="at">es_ci =</span> <span class="cn">TRUE</span>) <span class="co">#optional: confidence interval around effect size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>t(38) = -1.98, p = .027, d = -0.63 [-1.26; 0.01]</code></pre>
</div>
</div>
</section>
<section id="t-test-paired-samples" class="slide level2">
<h2><em>t</em>-Test: paired samples</h2>
<p>For paired <em>t</em>-tests, you have to work with the wide format of data (advantage: missing values become explicit):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" data-code-line-numbers="1-4,6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>sim_data_t_wide <span class="ot">=</span> sim_data_t <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">subject=</span><span class="fu">rep.int</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="fu">n</span>()<span class="sc">/</span><span class="dv">2</span>), <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span><span class="st">"group"</span>, <span class="at">values_from=</span><span class="st">"reaction_times"</span>, <span class="at">id_cols =</span> subject)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="fu">t.test</span>(<span class="at">x =</span> sim_data_t_wide <span class="sc">%&gt;%</span> <span class="fu">pull</span>(treatment),</span>
<span id="cb22-4"><a href="#cb22-4"></a>       <span class="at">y =</span> sim_data_t_wide <span class="sc">%&gt;%</span> <span class="fu">pull</span>(control),</span>
<span id="cb22-5"><a href="#cb22-5"></a>       <span class="at">alternative =</span> <span class="st">"less"</span>, </span>
<span id="cb22-6"><a href="#cb22-6"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="#cb22-7"></a>  apa<span class="sc">::</span><span class="fu">t_apa</span>(<span class="at">es_ci =</span> <span class="cn">TRUE</span>) <span class="co">#optional: confidence interval around effect size</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>t(19) = -1.98, p = .031, d = -0.44 [-0.90; 0.02]</code></pre>
</div>
</div>
</section>
<section id="assumptions-of-t-tests" class="slide level2">
<h2>Assumptions of <em>t</em>-Tests</h2>
<p>Before we run a <em>t</em>-test, we also want to check the assumptions for violations:</p>
<div>
<ul>
<li class="fragment"><p>The dependent variable is continuous (otherwise: chi²-test)</p></li>
<li class="fragment"><p>The data are independent (otherwise: <em>paired</em> sample <em>t</em>-test)</p></li>
<li class="fragment"><p>The variance between the groups is homogeneous (only for Student’s <em>t</em>-test, R uses Welch’s test by default)</p></li>
<li class="fragment"><p>The <em>residuals</em>&nbsp;are normally distributed for each group (otherwise: <code>wilcox.test</code>)</p></li>
</ul>
</div>
<div class="fragment">
<p>Oftentimes, the last assumption is misquoted as: “The <em>dependent variable</em> needs to be normally distributed”.<br>
In fact, only its <em>sampling distribution</em> needs to be (blue vs.&nbsp;grey distribution in the lecture on sampling [<a href="https://spressi.github.io/biostats/W5_Sampling.html#/example-sampling-distribution">direct link</a>]), which will always be the case for big enough samples due to the central limit theorem.</p>
</div>
</section>
<section id="assumptions-of-t-tests-normality" class="slide level2">
<h2>Assumptions of <em>t</em>-Tests: Normality</h2>
<p><strong>Test for normality of <em>residuals</em></strong> (for both groups separately): If points fall along the line nicely, assumption is met.</p>
<p>Treatment group:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>treatment <span class="ot">&lt;-</span> sim_data_t <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"treatment"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">mutate</span>(<span class="at">group_resid =</span> </span>
<span id="cb24-4"><a href="#cb24-4"></a>           reaction_times <span class="sc">-</span> <span class="fu">mean</span>(reaction_times)) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">pull</span>(group_resid)</span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">#base R QQ plot</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="fu">qqnorm</span>(treatment)</span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="fu">qqline</span>(treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-17-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="assumptions-of-t-tests-normality-1" class="slide level2">
<h2>Assumptions of <em>t</em>-Tests: Normality</h2>
<p><strong>Test for normality of <em>residuals</em></strong> (for both groups separately): If points fall along the line nicely, assumption is met.</p>
<p>Control group group:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb25" data-code-line-numbers="2,7-8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>control <span class="ot">&lt;-</span> sim_data_t <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="fu">mutate</span>(<span class="at">group_resid =</span> </span>
<span id="cb25-4"><a href="#cb25-4"></a>           reaction_times <span class="sc">-</span> <span class="fu">mean</span>(reaction_times)) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="fu">pull</span>(group_resid)</span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a><span class="co">#car's version highlighting (and returning) problematic values</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>car<span class="sc">::</span><span class="fu">qqPlot</span>(control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-18-1.png" width="960"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18  4</code></pre>
</div>
</div>
</div>
</section>
<section id="assumptions-of-t-tests-normality-2" class="slide level2">
<h2>Assumptions of <em>t</em>-Tests: Normality</h2>
<p>Alternatively, we can also run a <strong>Shapiro-Wilk</strong> test to check for <strong>deviations</strong> from normality:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">shapiro.test</span>(<span class="at">x =</span> treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  treatment
W = 0.91403, p-value = 0.0761</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">shapiro.test</span>(<span class="at">x =</span> control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  control
W = 0.96812, p-value = 0.7147</code></pre>
</div>
</div>
<p>If the test is non-significant, then we can conclude that normality of residuals is <strong>not</strong> violated.</p>
<p>⇒ Shapiro-Wilk tests for <strong>significant deveiations from normality</strong>.</p>
<aside class="notes">
<ol type="1">
<li>Transform your data to try and normalise the distribution. Not usually recommended these days but some still use it.</li>
<li>Use a non-parametric test. The non-parametric equivalent of the independent t-test is the Mann-Whitney and the equivalent of the paired-samples t-test is the Wilcoxon signed-ranks test. Though more modern permutation tests are better.</li>
<li>Do nothing. <a href="https://www.rips-irsp.com/articles/10.5334/irsp.82/">Delacre, Lakens &amp; Leys, 2017</a> argue that with a large enough sample (&gt;30), the Welch test is robust to deviations from assumptions. With very large samples normality is even less of an issue, so design studies with large samples.</li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="optional-activity-paired-samples-t-test" class="title-slide slide level1 center">
<h1>Optional Activity: Paired Samples <em>t</em>-Test</h1>
<p>Sometimes you have dependent data: These data are somehow correlated, e.g.&nbsp;they belong to the same subject (that you measured repeatedly across a <em>within-subject manipulation</em>).</p>
<div class="fragment">
<p>In this case, you would use a <strong>paired-samples <em>t</em>-test</strong>.</p>
</div>
<div class="fragment">
<p>Let’s run such a <em>t</em>-test with real data. We’ll use the <a href="https://github.com/spressi/biostats/blob/main/Data/Mehr%20Song%20and%20Spelke%202016%20Experiment%201.csv">Mehr Song and Spelke 2016 Experiment 1.csv</a> file (note that this is not a good file name!).</p>
</div>
</section>
<section id="mehr-song-spelke-2016" class="slide level2">
<h2>Mehr, Song, &amp; Spelke (2016)</h2>
<p><a href="https://github.com/spressi/biostats/blob/main/Data/Mehr%20Song%20and%20Spelke%202016%20Experiment%201.csv">In this dataset</a>, the authors examined whether infants exposed to certain songs would recognize strangers singing these lullabies as part of their social group. Parents sang certain lullabies to their infants for 1-2 weeks. During the experiment, the infants looked at videos of two strangers: First the strangers were just smiling (baseline phase), then they would sing either the familiar or an unfamiliar lullaby. Finally, the infants again saw the videos of the strangers smiling (test phase). Eye-tracking (duration looked at each stranger) was measured.</p>
<div class="fragment">
<p>Load the file into your Environment. Run the code and explain what happens:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>gaze <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Mehr Song and Spelke 2016 Experiment 1.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">filter</span>(exp1 <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">rename</span>(<span class="at">baseline =</span> Baseline_Proportion_Gaze_to_Singer,</span>
<span id="cb31-4"><a href="#cb31-4"></a>         <span class="at">test =</span> Test_Proportion_Gaze_to_Singer) <span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5"></a>  <span class="fu">select</span>(id, baseline, test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="assumptions-of-the-paired-samples-t-test" class="slide level2">
<h2>Assumptions of the Paired-Samples <em>t</em>-Test</h2>
<ol type="1">
<li><p>The data are continuous.</p></li>
<li><p>All participants should appear in both conditions/groups.</p></li>
<li><p>The <em>residuals</em> are normally distributed.</p></li>
</ol>
<div class="fragment">
<p>A paired-samples <em>t</em>-test actually tests whether the <em>difference</em> between two measurements is significantly different from 0 (= no difference/effect).</p>
<p>In our example data, this means that the <code>test</code> values are subtracted from the <code>baseline</code> values, and this difference is used as data.</p>
<p>To test the assumption that residuals are normally distributed, we thus calculate the residuals as follow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>gaze_residual <span class="ot">&lt;-</span> gaze <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> baseline <span class="sc">-</span> test) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">mutate</span>(<span class="at">group_resid =</span> diff <span class="sc">-</span> <span class="fu">mean</span>(diff))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="assumptions-of-the-paired-samples-t-test-1" class="slide level2">
<h2>Assumptions of the Paired-Samples <em>t</em>-Test</h2>
<div class="cell">

<div class="cell-output cell-output-stdout">
<pre><code>[1] 22 29</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  gaze_residual$group_resid
W = 0.97818, p-value = 0.7451</code></pre>
</div>
</div>
<img data-src="W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-23-1.png" width="960" class="r-stretch"></section>
<section id="descriptives-visualization" class="slide level2">
<h2>Descriptives &amp; Visualization</h2>
<p>For the visualization, we need the data in long format (this is identical for between-subject groups):</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>gaze_tidy <span class="ot">&lt;-</span> gaze <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"phase"</span>, </span>
<span id="cb35-3"><a href="#cb35-3"></a>               <span class="at">values_to =</span> <span class="st">"looking_time"</span>, </span>
<span id="cb35-4"><a href="#cb35-4"></a>               <span class="at">cols =</span> <span class="fu">c</span>(baseline, test))</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="co"># boxplot</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>gaze_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>phase, <span class="at">y=</span>looking_time)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<p><img data-src="W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-24-1.png" width="960"></p>
</div>
</div>
</div>
<p>We can also calculate the means and SDs per phase:</p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>gaze_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">summarize</span>(<span class="at">.by =</span> phase,</span>
<span id="cb36-3"><a href="#cb36-3"></a>            <span class="at">mean_looking =</span> <span class="fu">mean</span>(looking_time),</span>
<span id="cb36-4"><a href="#cb36-4"></a>            <span class="at">sd_looking =</span> <span class="fu">sd</span>(looking_time),</span>
<span id="cb36-5"><a href="#cb36-5"></a>            <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  phase    mean_looking sd_looking     n
  &lt;chr&gt;           &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
1 baseline        0.521      0.177    32
2 test            0.593      0.179    32</code></pre>
</div>
</div>
</div>
</section>
<section id="paired-samples-t-test-in-r" class="slide level2">
<h2>Paired Samples <em>t</em>-Test in <code>R</code></h2>
<p>Any ideas how you would specify the paired samples <em>t</em>-test in <code>R</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">with</span>(gaze, <span class="fu">t.test</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb38-2"><a href="#cb38-2"></a>                  <span class="at">paired =</span> <span class="cn">NULL</span>,</span>
<span id="cb38-3"><a href="#cb38-3"></a>                  <span class="at">alternative =</span> <span class="cn">NULL</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">with</span>(gaze, <span class="fu">t.test</span>(<span class="at">x =</span> baseline, <span class="at">y =</span> test,</span>
<span id="cb39-2"><a href="#cb39-2"></a>                  <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-3"><a href="#cb39-3"></a>                  <span class="at">alternative =</span> <span class="st">"two.sided"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  baseline and test
t = -2.4164, df = 31, p-value = 0.02175
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.13349698 -0.01129217
sample estimates:
mean difference 
    -0.07239458 </code></pre>
</div>
</div>
</div>
</section>
<section id="effect-size-for-the-t-test" class="slide level2">
<h2>Effect Size for the <em>t</em>-Test</h2>
<p>You can (and should!) of course calculate and report effect sizes for your test statistics to get an impression of how practically relevant the effect is.</p>
<p>For the <em>t</em>-tests, you would calculate <strong>Cohen’s d</strong> (e.g., using the <code>effectsize</code> package):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">with</span>(gaze, effectsize<span class="sc">::</span><span class="fu">cohens_d</span>(baseline, test, <span class="at">paired =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cohen's d |         95% CI
--------------------------
-0.43     | [-0.79, -0.06]</code></pre>
</div>
</div>
<div class="fragment">
<p><br>
Or just use the <code>apa</code> package and you get everything in one go:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">with</span>(gaze, <span class="co">#the with function allows to call columns as if they were variables (but pipe function doesn't work with it)</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>     <span class="fu">t.test</span>(baseline, test, <span class="at">paired =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3"></a>  apa<span class="sc">::</span><span class="fu">t_apa</span>(<span class="at">es_ci =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>t(31) = -2.42, p = .022, d = -0.43 [-0.79; -0.06]</code></pre>
</div>
</div>
<!--
## Write Up of the *t*-Test

What do you think you should report in your results section?

. . .

-   the means and SDs per condition (or the mean difference and the SD of the difference between conditions)

-   the test statistic *t,* incl. degrees of freedom

-   the p-value

-   the effect size

. . .

> At test stage (M = .59, SD = .18), infants showed a significantly longer preferential looking time to the singer of the familiar melody than they had shown the same singer at baseline (M = .52, SD = .18), *t*(31) = 2.42, *p* = .022, *d* = .41.
-->
</div>
</section>
<section id="summary-optional-activity" class="slide level2">
<h2>Summary: Optional Activity</h2>
<div>
<ul>
<li class="fragment"><p>Most things are similar between independent and dependent sample <em>t</em>-tests</p></li>
<li class="fragment"><p>Make sure to include <code>paired = TRUE</code> for repeated measures to get correct results</p></li>
<li class="fragment"><p>Recommendation: Use <code>apa::t_apa()</code> with <code>es.ci = TRUE</code> to get (most of) the information you need</p></li>
<li class="fragment"><p>It is often a good idea to also report means and standard deviations per group<br>
(<code>summarize</code> with <code>.by</code> argument)</p></li>
<li class="fragment"><p>Plotting: Unfortunately, (between subjects) confidence intervals are not diagnostic for the significance of dependent samples. Instead, we need the <strong>confidence interval around the paired differences (i.e., the within subject changes)</strong>.</p></li>
</ul>
</div>
</section>
<section id="kinds-of-error-variance-in-paired-samples" class="slide level2">
<h2>Kinds of Error Variance in paired samples</h2>
<aside class="notes">
<p>Use <code>Notes Canvas</code> (paint brush icon on bottom left) to draw worst possibility of paired differences in “Raw Data” and resulting increase in within-subjects error variance while between-subjects variance remains fixed.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- DOI not working: https://doi.org/10.2478/v10053-008-0133-x -->

<img data-src="images/PfisterJanczyk2013.png" class="r-stretch quarto-figure-center"><p class="caption"><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3699740/">Pfister &amp; Janczyk (2013)</a>, Fig. 1</p></section></section>
<section>
<section id="correlation-preparation" class="title-slide slide level1 center">
<h1>Correlation: Preparation</h1>
<p>If we have two continuous variables, we can look at their relationship using <strong>correlation</strong>. In the data you just used, we have two continuous variables: the repeated measures of gaze.</p>
<p>If you skipped the previous activity, here is what you need:</p>
<ol type="1">
<li><p>Download <a href="https://github.com/spressi/biostats/blob/main/Data/Mehr%20Song%20and%20Spelke%202016%20Experiment%201.csv">Mehr Song and Spelke 2016 Experiment 1.csv</a> (download button near the top right) into your project folder and</p></li>
<li><p>run this code:</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>gaze <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Mehr Song and Spelke 2016 Experiment 1.csv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>  <span class="fu">filter</span>(exp1 <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3"></a>  <span class="fu">rename</span>(<span class="at">baseline =</span> Baseline_Proportion_Gaze_to_Singer,</span>
<span id="cb45-4"><a href="#cb45-4"></a>         <span class="at">test =</span> Test_Proportion_Gaze_to_Singer) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="fu">select</span>(id, baseline, test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="correlation-test" class="slide level2">
<h2>Correlation Test</h2>
<p>We might be interested in whether there is a relationship between the two measures of gaze, i.e., whether those children who looked at the stranger more at baseline would also look more at the follow-up test (here: indicating stability of preferences).</p>
<div class="fragment">
<p>Similar to the paired <em>t</em>-Test, the continuous variables are also “paired” within subjects. Thus, we can use a similar syntax to the previous optional activity of the paired <em>t</em>-test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">cor.test</span>(<span class="at">x =</span> gaze <span class="sc">%&gt;%</span> <span class="fu">pull</span>(baseline), </span>
<span id="cb46-2"><a href="#cb46-2"></a>         <span class="at">y =</span> gaze <span class="sc">%&gt;%</span> <span class="fu">pull</span>(test), </span>
<span id="cb46-3"><a href="#cb46-3"></a>         <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="co">#default</span></span>
<span id="cb46-4"><a href="#cb46-4"></a>         <span class="at">alternative =</span> <span class="st">"two.sided"</span>) <span class="sc">%&gt;%</span> <span class="co">#default</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>  apa<span class="sc">::</span><span class="fu">cor_apa</span>(<span class="at">r_ci =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>r(30) = .55 [.24; .75], p = .001</code></pre>
</div>
</div>
<p>Note: We don’t have to indicate <code>paired = TRUE</code> because correlations only work for paired values.</p>
<!-- 
## Correlations: Write Up

Once again, the `apa` package offers help to summarize the results:


::: {.cell}

```{.r .cell-code}
cor.test(x = gaze %>% pull(baseline), 
         y = gaze %>% pull(test), 
         method = "pearson", 
         alternative = "two.sided") %>% 
  apa::cor_apa(r_ci=TRUE)
```

::: {.cell-output .cell-output-stdout}
```
r(30) = .55 [.24; .75], p = .001
```
:::
:::

-->
</div>
</section>
<section id="correlations-write-up" class="slide level2">
<h2>Correlations: Write Up</h2>
<p>You can even use <code>report()</code> to get an automatic suggestion of how to report the results (works with a lot of different models!).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">library</span>(report)</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="fu">with</span>(gaze, <span class="fu">cor.test</span>(<span class="at">x =</span> baseline, </span>
<span id="cb48-3"><a href="#cb48-3"></a>                    <span class="at">y =</span> test, </span>
<span id="cb48-4"><a href="#cb48-4"></a>                    <span class="at">method =</span> <span class="st">"pearson"</span>, </span>
<span id="cb48-5"><a href="#cb48-5"></a>                    <span class="at">alternative =</span> <span class="st">"two.sided"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6"></a>  <span class="fu">report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Funder's (2019) recommendations.

The Pearson's product-moment correlation between baseline and test is positive,
statistically significant, and very large (r = 0.55, 95% CI [0.24, 0.75], t(30)
= 3.57, p = 0.001)</code></pre>
</div>
</div>
<aside class="notes">
<p>We mainly use this dataset so that you don’t have to load another one, but in practice you would either run a <em>t</em>-test or a correlation, not necessarily both!</p>
<p>The t-tests answers whether there is a change across all participants between the two time points, the correlation answers the question whether those who score high at one time point would also score high at the next (regardless of overall level).</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="correlations-notes" class="slide level2">
<h2>Correlations: Notes</h2>
<p>There are also some <strong>assumptions</strong> that need to be checked:</p>
<ol type="1">
<li><p>Are the data <em>continuous</em>? (for ordinal values: Spearman’s rho)</p></li>
<li><p>Is there a data point for each participant on both variables? (paired values)</p></li>
<li><p>Are the residuals <em>normally distributed</em>?</p></li>
<li><p>Does the relationship between variables appear <em>linear</em>?</p></li>
<li><p>Does the spread have <em>homoscedasticity</em>? (Variance of residuals should be constant across x-axis)<br>
Note: This is very hard to judge by eye and is not the same as the confidence band around the regression line to show constant width. In fact, the latter will always be larger near the ends of the regression line due to how it is computed.</p></li>
</ol>
<p>Please see <a href="https://psyteachr.github.io/quant-fun-v2/correlations.html#assumptions-of-the-test">the text book for how to test these assumptions</a>.</p>
<p>You should - as always - also report the descriptive statistics (such as mean and SD of both variables).</p>
<p>You can also report and visualize multiple correlations at once, using a scatterplot matrix or heatmaps. Check out e.g.&nbsp;the <a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html"><code>corrplot</code> package</a>!</p>
</section></section>
<section>
<section id="activity-3" class="title-slide slide level1 center">
<h1>Activity 3</h1>
<p>What if we have more than two groups and/or more than one variable? For example, what if we have one variable <code>treatment</code> (with the factor levels <em>treatment 1, treatment 2,</em> and <em>control</em>) and possibly another variable called <code>timepoint</code> (<em>baseline, post-test</em>)?</p>
<p>Which statistical test could we use?</p>
<div class="fragment">
<p>We would possibly run an ANOVA!</p>
<p>If we have only one factor (e.g.&nbsp;treatment with three factor levels), we would do an <strong>one-way ANOVA</strong>.<br>
If we have more than one factor but only between-subjects variables, we would run an <strong>ANOVA</strong>.<br>
If we have at least one within-subjects factor, we would run a <strong>repeated measures (or mixed) ANOVA</strong>.</p>
<p>The names are only there for historical reasons. With the right R packages, we only have to ask ourselves if a variable changes between subjects or within subjects.</p>
<p>Due to their potency and wide-spread use, we will cover ANOVAs even more next time in the context of the <strong>linear model</strong>.</p>
<aside class="notes">
<p>we will today only look at one-way anovas! Next time we will cover the case when we have more than one IV/predictor!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</div>
</section>
<section id="one-way-anova" class="slide level2">
<h2>One-Way ANOVA</h2>
<p>For this activity, we will use data from a study about memory of traumatic events (see <a href="https://psyteachr.github.io/quant-fun-v2/one-way-anova.html">the textbook</a> for details). In short, the authors of the paper were interested to find out whether:</p>
<blockquote>
<p>reconsolidation - the process during which memories become malleable when recalled - can be blocked using a cognitive task and whether such an approach can reduce these unbidden intrusions.</p>
</blockquote>
<div>
<ol type="1">
<li class="fragment"><p>Download the data <a href="https://github.com/spressi/biostats/blob/main/Data/James%20Holmes_Expt%202_DATA.csv">James Holmes_Expt 2_DATA.csv</a>. This time, put it in a <strong>subfolder</strong> of your project called “Data”.</p></li>
<li class="fragment"><p>Add a column to the dataframe called <code>subject</code> that equals the <code>row_number()</code>, which will act as a participant ID.</p></li>
<li class="fragment"><p><code>rename()</code>: <code>Days_One_to_Seven_Image_Based_Intrusions_in_Intrusion_Diary</code> to <code>intrusions.</code></p></li>
<li class="fragment"><p>Select only the columns <code>subject</code>, <code>Condition</code> and <code>intrusions</code>.</p></li>
<li class="fragment"><p>Change the variable <code>Condition</code> from <code>numeric</code> to a <code>factor</code> using <code>as.factor()</code></p></li>
</ol>
</div>
</section>
<section id="one-way-anova-1" class="slide level2">
<h2>One-Way ANOVA</h2>
<ol type="1">
<li><p>Download the data <a href="https://github.com/spressi/biostats/blob/main/Data/James%20Holmes_Expt%202_DATA.csv">James Holmes_Expt 2_DATA.csv</a>. This time, put it in a <strong>subfolder</strong> of your project called “Data”.</p></li>
<li><p>Add a column to the dataframe called <code>subject</code> that equals the <code>row_number()</code>, which will act as a participant ID.</p></li>
<li><p><code>rename()</code>: <code>Days_One_to_Seven_Image_Based_Intrusions_in_Intrusion_Diary</code> to <code>intrusions.</code></p></li>
<li><p>Select only the columns <code>subject</code>, <code>Condition</code> and <code>intrusions</code>.</p></li>
<li><p>Change the variable <code>Condition</code> from <code>numeric</code> to a <code>factor</code> using <code>as.factor()</code></p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/James Holmes_Expt 2_DATA.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="#cb50-4"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"subject"</span>) <span class="sc">%&gt;%</span> <span class="co">#mutate(subject = 1:n()) %&gt;% </span></span>
<span id="cb50-5"><a href="#cb50-5"></a>  <span class="fu">rename</span>(<span class="at">intrusions =</span> Days_One_to_Seven_Image_Based_Intrusions_in_Intrusion_Diary) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6"></a>  <span class="fu">select</span>(subject, Condition, intrusions) <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7"></a>  <span class="fu">mutate</span>(<span class="at">Condition =</span> <span class="fu">as.factor</span>(Condition))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>we will today only look at one-way anovas! Next week we will cover the case when we have more than one IV/predictor!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="one-way-anova-2" class="slide level2">
<h2>One-Way ANOVA</h2>
<p>Create summary/descriptive statistics and visualize the data.</p>
<p>As summary statistics, we want the mean, SD, and SE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>sum_dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(intrusions),</span>
<span id="cb51-3"><a href="#cb51-3"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(intrusions),</span>
<span id="cb51-4"><a href="#cb51-4"></a>            <span class="at">se =</span> confintr<span class="sc">::</span><span class="fu">se_mean</span>(intrusions), <span class="co">#no native R function :(</span></span>
<span id="cb51-5"><a href="#cb51-5"></a>            <span class="at">.by =</span> Condition)</span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="fu">print</span>(sum_dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  Condition  mean    sd    se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1          5.11  4.23 0.996
2 2          1.89  1.75 0.411
3 3          3.89  2.89 0.681
4 4          4.83  3.33 0.785</code></pre>
</div>
</div>
<p>Note: The names of the factor levels are missing. If we wanted to plot the data, we should have added them in the previous step. For brevity, we will not do it this time.</p>
<!--
. . .


::: {.cell output-location='column-fragment'}

```{.r .cell-code}
ggplot(sum_dat, aes(x = Condition, y = mean, fill = Condition)) +
  stat_summary(fun = "mean", geom = "bar", show.legend = FALSE) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se), width = 0.25) +
  scale_x_discrete(labels = c("No-task control", "Reactivation plus Tetris", "Tetris only", "Reactivation only")) +
  scale_y_continuous(limits = c(0,7), 
                     breaks = c(0,1,2,3,4,5,6,7), 
                     name = "Intrusive-Memory Frequency (Mean for the Week)") 
```

::: {.cell-output-display}
![](W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-36-1.png){width=960}
:::
:::

-->
</section>
<section id="one-way-anova-3" class="slide level2">
<h2>One-Way ANOVA</h2>
<ol type="1">
<li>Run the ANOVA using <code>lm()</code> and formula notation.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(intrusions <span class="sc">~</span> Condition, <span class="at">data =</span> dat)</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="fu">anova</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: intrusions
          Df Sum Sq Mean Sq F value  Pr(&gt;F)  
Condition  3 114.82  38.273  3.7948 0.01409 *
Residuals 68 685.83  10.086                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Using <code>afex::aov_ez</code>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">library</span>(afex)</span>
<span id="cb55-2"><a href="#cb55-2"></a>mod <span class="ot">&lt;-</span> <span class="fu">aov_ez</span>(<span class="at">id =</span> <span class="st">"subject"</span>, <span class="co"># the column containing the subject IDs</span></span>
<span id="cb55-3"><a href="#cb55-3"></a>              <span class="at">dv =</span> <span class="st">"intrusions"</span>, <span class="co"># the DV </span></span>
<span id="cb55-4"><a href="#cb55-4"></a>              <span class="at">between =</span> <span class="st">"Condition"</span>, <span class="co"># the between-subject variable</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>              <span class="at">es =</span> <span class="st">"pes"</span>, <span class="co"># can output an effect size! we want partial eta-squared</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>              <span class="at">type =</span> <span class="dv">3</span>, <span class="co"># there are both reasons for 2 and 3 (not covered here)</span></span>
<span id="cb55-7"><a href="#cb55-7"></a>              <span class="at">include_aov =</span> <span class="cn">TRUE</span>, <span class="co"># needed for some calculations with emmeans but takes longer</span></span>
<span id="cb55-8"><a href="#cb55-8"></a>              <span class="at">data =</span> dat)</span>
<span id="cb55-9"><a href="#cb55-9"></a><span class="fu">anova</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type 3 tests)

Response: intrusions
          num Df den Df    MSE      F     ges  Pr(&gt;F)  
Condition      3     68 10.086 3.7948 0.14341 0.01409 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="checking-the-assumptions" class="slide level2">
<h2>Checking the Assumptions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb57-2"><a href="#cb57-2"></a></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="fu">check_model</span>(mod1) <span class="co"># doesn't work for ezANOVA output!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-39-1.png" width="960" class="r-stretch"></section>
<section id="checking-the-assumptions-1" class="slide level2">
<h2>Checking the Assumptions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># "manually" check normality of residuals </span></span>
<span id="cb58-2"><a href="#cb58-2"></a></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="fu">qqPlot</span>(mod<span class="sc">$</span>aov<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="cell-output cell-output-stdout">
<pre><code>[1]  3 57</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">shapiro.test</span>(mod<span class="sc">$</span>aov<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  mod$aov$residuals
W = 0.87739, p-value = 4.252e-06</code></pre>
</div>
</div>
<img data-src="W9_FirstAnalysisR_files/figure-revealjs/unnamed-chunk-40-1.png" width="960" class="r-stretch"></section>
<section id="checking-the-assumptions-2" class="slide level2">
<h2>Checking the Assumptions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co"># check homogeneity of variance</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="fu">test_levene</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Variances differ between groups (Levene's Test, p = 0.039).</code></pre>
</div>
</div>
<p>Both assumptions are not met!</p>
<p><strong>But</strong> ANOVAS are quite robust to (minor) deviations…</p>
<p>If the assumptions are violated more, you could…<br>
- run a non-parametric test (Kruskall-Wallis for between-subjects designs or Friedman for repeated measures)<br>
- transform the data (see Field et al., 2009)<br>
- use bootstrapping (see Field et al., 2009)</p>
</section>
<section id="post-hoc-tests" class="slide level2">
<h2>Post-Hoc Tests</h2>
<p>So now we know that there are differences between the <code>Condition</code>s, but we don’t know yet which groups differ from each other. We could thus calculate <em>pairwise comparisons</em> or <em>post-hoc t-tests</em> to compare each condition to the others by filtering the data (so that only two conditions remain) and running <em>t</em>-tests.</p>
<p>A more convenient way is to use the <code>emmeans()</code> function from the package with the same name. We can also adjust the tests for <em>multiple comparisons</em> directly.</p>
<p>We could also define specific <em>contrasts</em> to test <strong>a priori</strong> (i.e., based on hypotheses). But we will skip this here.</p>
</section>
<section id="post-hoc-tests-1" class="slide level2">
<h2>Post-Hoc Tests</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb64-2"><a href="#cb64-2"></a>mod <span class="sc">%&gt;%</span> <span class="fu">emmeans</span>(pairwise <span class="sc">~</span> Condition, <span class="at">adjust =</span> <span class="st">"bonferroni"</span>) <span class="co"># also works with mod1!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 Condition emmean    SE df lower.CL upper.CL
 1           5.11 0.749 68    3.617     6.60
 2           1.89 0.749 68    0.395     3.38
 3           3.89 0.749 68    2.395     5.38
 4           4.83 0.749 68    3.340     6.33

Confidence level used: 0.95 

$contrasts
 contrast                estimate   SE df t.ratio p.value
 Condition1 - Condition2    3.222 1.06 68   3.044  0.0199
 Condition1 - Condition3    1.222 1.06 68   1.155  1.0000
 Condition1 - Condition4    0.278 1.06 68   0.262  1.0000
 Condition2 - Condition3   -2.000 1.06 68  -1.889  0.3787
 Condition2 - Condition4   -2.944 1.06 68  -2.781  0.0420
 Condition3 - Condition4   -0.944 1.06 68  -0.892  1.0000

P value adjustment: bonferroni method for 6 tests </code></pre>
</div>
</div>
<aside class="notes">
<p>Should we adjust for multiple comparisons? It depends. There are good reasons for either.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="anova-effect-sizes" class="slide level2">
<h2>ANOVA: Effect Sizes</h2>
<p>The most common effect size estimate for an ANOVA is <em>partial eta squared</em> <span class="math inline">\(\eta_p^2\)</span> (as we calculated with <code>afex::aov_ez</code> before). We get <em>one per factor</em> and it summarizes all pairwise effects within it.</p>
<div class="fragment">
<p>We could also calculate Cohen’s <em>d</em> for each pairwise comparison within the factor but this is tedious and gets confusing quickly (1 factor with 5 levels = 10 effects; 3 factors with 5 levels each = 30 effects). It’s still sad that <code>emmeans</code> doesn’t output it as one additional column.</p>
<!--

::: {.cell}

```{.r .cell-code}
library(lsr)

d_1_2 <- cohensD(intrusions ~ Condition, 
                 data = filter(dat, Condition %in% c(1,2)) %>% 
                   droplevels())

d_1_3 <- cohensD(intrusions ~ Condition, 
                 data = filter(dat, Condition %in% c(1,3)) %>%
                   droplevels()) 

# and so forth...

d_1_2
```

::: {.cell-output .cell-output-stdout}
```
[1] 0.9964172
```
:::

```{.r .cell-code}
d_1_3
```

::: {.cell-output .cell-output-stdout}
```
[1] 0.3376282
```
:::
:::

-->
</div>
</section>
<section id="anova-power" class="slide level2">
<h2>ANOVA: Power</h2>
<p>Effect sizes are important to calculate the <strong>statistical power</strong> of your study before conducting it. Use an estimated effect size based on prior research:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb66-2"><a href="#cb66-2"></a><span class="fu">pwr.anova.test</span>(<span class="at">k =</span> <span class="dv">4</span>, <span class="at">f =</span> .<span class="dv">4</span>, <span class="at">sig.level =</span> .<span class="dv">05</span>, <span class="at">power =</span> .<span class="dv">8</span>) <span class="co">#we leave out the n parameter to let it be calculated</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

              k = 4
              n = 18.04262
              f = 0.4
      sig.level = 0.05
          power = 0.8

NOTE: n is number in each group</code></pre>
</div>
</div>
<p>Note: <code>f</code> is “Cohen’s <em>f</em>”. You can convert your <span class="math inline">\(\eta_p^2\)</span> to (partial) <code>f</code> using <code>effectsize</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>effectsize<span class="sc">::</span><span class="fu">eta2_to_f</span>(.<span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.420084</code></pre>
</div>
</div>
</section>
<section id="write-up" class="slide level2">
<h2>Write Up</h2>
<p>Once again, the <code>apa</code> package helps us here - if we used <code>afex::aov_ez</code> instead of <code>lm</code> 😅:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>mod <span class="sc">%&gt;%</span> apa<span class="sc">::</span><span class="fu">anova_apa</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Effect                                              
1 (Intercept) F(1, 68) = 110.29, p &lt; .001, petasq = .62 ***
2   Condition F(3, 68) =   3.79, p = .014, petasq = .14 *  </code></pre>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>mod <span class="sc">%&gt;%</span> <span class="fu">emmeans</span>(<span class="st">"Condition"</span>) <span class="sc">%&gt;%</span> <span class="fu">pairs</span>(<span class="at">adjust=</span><span class="st">"none"</span>) <span class="co">#follow up t-tests without adjustment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                estimate   SE df t.ratio p.value
 Condition1 - Condition2    3.222 1.06 68   3.044  0.0033
 Condition1 - Condition3    1.222 1.06 68   1.155  0.2523
 Condition1 - Condition4    0.278 1.06 68   0.262  0.7938
 Condition2 - Condition3   -2.000 1.06 68  -1.889  0.0631
 Condition2 - Condition4   -2.944 1.06 68  -2.781  0.0070
 Condition3 - Condition4   -0.944 1.06 68  -0.892  0.3755</code></pre>
</div>
</div>
<p>Looking at contrasts including condition 1 (control group): Only condition 2 different.<br>
Let’s get the associated effect size of this specific contrast:</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">library</span>(lsr)</span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="fu">cohensD</span>(intrusions <span class="sc">~</span> Condition, </span>
<span id="cb74-3"><a href="#cb74-3"></a>        <span class="at">data =</span> <span class="fu">filter</span>(dat, Condition <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">droplevels</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9964172</code></pre>
</div>
</div>
</div>
</section>
<section id="write-up-1" class="slide level2">
<h2>Write Up</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       Effect                                              
1 (Intercept) F(1, 68) = 110.29, p &lt; .001, petasq = .62 ***
2   Condition F(3, 68) =   3.79, p = .014, petasq = .14 *  </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast                estimate   SE df t.ratio p.value
 Condition1 - Condition2    3.222 1.06 68   3.044  0.0033
 Condition1 - Condition3    1.222 1.06 68   1.155  0.2523
 Condition1 - Condition4    0.278 1.06 68   0.262  0.7938
 Condition2 - Condition3   -2.000 1.06 68  -1.889  0.0631
 Condition2 - Condition4   -2.944 1.06 68  -2.781  0.0070
 Condition3 - Condition4   -0.944 1.06 68  -0.892  0.3755</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9964172</code></pre>
</div>
</div>
<blockquote>
<p>There was a significant difference between groups in overall intrusion frequency in daily life, <span class="math inline">\(F(3, 68) = 3.79, p = 0.014, \eta_p^2 = .14\)</span>. Pairwise comparisons demonstrated that relative to the no-task control group, only those in the reactivation-plus-Tetris group, <span class="math inline">\(t(68) = 3.04, p &lt; 0.01, d = 1.00\)</span>, experienced significantly fewer intrusive memories…</p>
</blockquote>
</section></section>
<section id="thanks" class="title-slide slide level1 center">
<h1>Thanks!</h1>
<p>Learning objectives:</p>
<ul>
<li>Be able to run the following tests in <code>R</code>, check their assumptions, and report the results: Chi², <em>t</em>-tests, correlation, and one-way ANOVA</li>
</ul>
<p>Next:</p>
<ul>
<li>General Linear Model!</li>
</ul>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>